{% load custom_filters %}

<div class="grid grid-cols-1 md:grid-cols-2 mb-4 gap-x-4 gap-y-4">
    <figure class="rounded-lg flex flex-col items-center justify-center p-2 text-center bg-white border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700">
        <blockquote class="w-full mb-2 text-gray-500 dark:text-gray-400">
            <canvas id="bytesChart"></canvas>
        </blockquote>
        <button id="resetBytesZoom" class="hover:cursor-pointer mt-2 text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700">Reset Zoom</button>
    </figure>
    <figure class="rounded-lg flex flex-col items-center justify-center p-2 text-center bg-white border-b border-gray-200 dark:bg-gray-800 dark:border-gray-700">
        <blockquote class="w-full mb-2 text-gray-500 dark:text-gray-400">
            <canvas id="jobsChart"></canvas>
        </blockquote>
        <button id="resetJobsZoom" class="hover:cursor-pointer mt-2 text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-700">Reset Zoom</button>
    </figure>
</div>

{% comment %} Scripts below {% endcomment %}
<script>
    const bytesChart = document.getElementById('bytesChart');
    const bytesChartInstance = new Chart(bytesChart, {
        type: 'line',
        data: {
            labels: [
            {% for day in days %}
            '{{ day }}'
            {% if not forloop.last %},{% endif %}
            {% endfor %}
            ],
            datasets: [{
                label: 'Gigabytes',
                data: [
                    {% for byte in bytes %}
                    {{ byte }}
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                ],
                borderWidth: 1
            },
            {
                label: 'Server Side Copy Gigabytes',
                data: [
                    {% for byte in serverSideCopyBytes %}
                    {{ byte }}
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                ],
                borderWidth: 1
            },
            {
                label: 'Server Side Move Gigabytes',
                data: [
                    {% for byte in serverSideMoveBytes %}
                    {{ byte }}
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        color: 'rgba(255, 255, 255, 1)', // Change y-axis text color
                        callback: function(value) {
                            return value + ' GB'; // Add "GB" to the y-axis labels
                        }
                    }
                },
                x: {
                    ticks: {
                        color: 'rgba(255, 255, 255, 1)' // Change x-axis text color
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'rgba(255, 255, 255, 1)' // Change legend text color
                    }
                },
                zoom: {
                    pan: {
                        enabled: true,
                        mode: 'x',
                        modifierKey: 'ctrl',
                    },
                    zoom: {
                        drag: {
                            enabled: true
                        },
                        mode: 'x'
                    }
                }
            }
        }
    });

    document.getElementById('resetBytesZoom').addEventListener('click', function() {
        bytesChartInstance.resetZoom();
    });
</script>
<script>
    const jobsChart = document.getElementById('jobsChart');
    const jobsChartInstance = new Chart(jobsChart, {
        type: 'line',
        data: {
            labels: [
            {% for day in days %}
            '{{ day }}'
            {% if not forloop.last %},{% endif %}
            {% endfor %}
            ],
            datasets: [{
                label: 'Jobs Run',
                data: [
                    {% for count in jobsRun %}
                    {{ count }}
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                ],
                borderWidth: 1
            },
            {
                label: 'Errored Jobs',
                data: [
                    {% for count in jobsErrored %}
                    {{ count }}
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                y: {
                    stacked: true,
                    ticks: {
                        color: 'rgba(255, 255, 255, 1)' // Change y-axis text color
                    }
                },
                x: {
                    ticks: {
                        color: 'rgba(255, 255, 255, 1)' // Change x-axis text color
                    }
                }
            },
            plugins: {
                legend: {
                    labels: {
                        color: 'rgba(255, 255, 255, 1)' // Change legend text color
                    }
                },
                zoom: {
                    pan: {
                        enabled: true,
                        mode: 'x',
                        modifierKey: 'ctrl',
                    },
                    zoom: {
                        drag: {
                            enabled: true
                        },
                        mode: 'x'
                    }
                }
            }
        }
    });

    document.getElementById('resetJobsZoom').addEventListener('click', function() {
        jobsChartInstance.resetZoom();
    });
</script>